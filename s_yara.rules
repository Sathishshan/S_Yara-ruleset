rule malware_1001
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-18"
        category = "malicious/phishing/deface"
        
    strings:        
         $S1 = /hacked\s+by/i
         
    condition:
         $S1
}

rule malware_1002
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-18"
        category = "malicious/shell/backdoor"
        
    strings:        
         $S1 = /b374k/i
         $S2 = /\$s_pass\s?=/
         $S3 = /eval\("\?>"\.gzinflate\(base64_decode\("7b2HmtvIsSj8BH4HH/
         
    condition:
         $S1 and $S2 and $S3
}

rule malware_1003
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-18"
        category = "malicious/shell/backdoor"
        
    strings:        
         $S1 = /str_replace\(\$_SERVER\[\'DOCUMENT_ROOT\'\],'',\$_SESSION\['currentdir'\]/
         $S2 = /AK\-74\sSecurity\sTeam\sWeb\sShell/i
         $S3 = /\(\(\$perms\s&\s0x[0-9]{4}\)/
         
    condition:
         $S1 and $S2 or $S3
}

rule malware_1004
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-20"
        category = "phishing/shell/backdoor"

    strings:
         $S1 = /(r57shell|99shell|shellbot|phpshell|bankofamerica.com)/i

    condition:
         $S1
}

rule malware_1005
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious/.ico"

    strings:
         $S1 = /(\/\*\w{3,10}\*\/)\s+@include\s+"\\[A-z0-9\/\.-]+\.i\\[A-z0-9]+";\s+(\/\*\w{3,10}\*\/)/
         $S2 = /(\/\*\w{3,10}\*\/)/
         $S3 = /(\.i\\143o";)/

    condition:
         $S1 or $S2 and $S3
}

rule malware_1006
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious"

    strings:
	$S1 = /\$GLOBALS\['/
	$S2 = { 247b225c7834375c7834635c783466 }
        $S3 = /\{eval(\/\*\w{2,10}\*\/)?/

    condition:
        $S1 and $S2 and $S3
}
