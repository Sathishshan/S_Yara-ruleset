/*
 * @package    s_yara-ruleset
 *--------------------------------------------------------------- 
 * @copyright  Copyright (C) 2019 Open Source
 * @license    GNU GENERAL PUBLIC LICENSE Version 3
 *---------------------------------------------------------------
 */

rule malware_1001
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-18"
        category = "malicious/phishing/deface"
        
    strings:        
         $S1 = /hacked\s+by/i
         
    condition:
         $S1
}

rule malware_1002
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-18"
        category = "malicious/shell/backdoor"
        
    strings:        
         $S1 = /b374k/i
         $S2 = /\$s_pass\s?=/
         $S3 = /eval\("\?>"\.gzinflate\(base64_decode\("7b2HmtvIsSj8BH4HH/
         
    condition:
         $S1 and $S2 and $S3
}

rule malware_1003
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-18"
        category = "malicious/shell/backdoor"
        
    strings:        
         $S1 = /str_replace\(\$_SERVER\[\'DOCUMENT_ROOT\'\],'',\$_SESSION\['currentdir'\]/
         $S2 = /AK\-74\sSecurity\sTeam\sWeb\sShell/i
         $S3 = /\(\(\$perms\s&\s0x[0-9]{4}\)/
         
    condition:
         $S1 and $S2 or $S3
}

rule malware_1004
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-20"
        category = "phishing/shell/backdoor"

    strings:
         $S1 = /(r57shell|99shell|shellbot|phpshell|bankofamerica\.com)/i

    condition:
         $S1
}

rule malware_1005
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious/.ico"

    strings:
         $S1 = /(\/\*\w{3,10}\*\/)\s+@include\s+"\\[A-z0-9\/\.-]+\.i\\[A-z0-9]+";\s+(\/\*\w{3,10}\*\/)/
         $S2 = /(\/\*\w{3,10}\*\/)/
         $S3 = /(@include\s")/

    condition:
         ($S1) or (#S2 >= 2) and ($S3)
}

rule malware_1006
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious"

    strings:
	$S1 = /\$GLOBALS\['/
	$S2 = { 247b225c7834375c7834635c783466 }
        $S3 = /\{eval(\/\*\w{2,10}\*\/)?/

    condition:
        $S1 and $S2 and $S3
}

rule malware_1007
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious"

    strings:
	$S1 = /\)\s\{eval\(\$\w{3,7}\[[0-9]\]\(/
	$S2 = /;\$\w{3,7}\s=\sArray\(\);\$\w{3,7}\[\]\s=\s\$\w{3,7}\[[0-9]\]\.\$/
        $S3 = /foreach\s\(\$\w{3,7}\[[0-9]\]\(\$_COOKIE\,\s\$_POST\)/

    condition:
        $S1 and $S2 and $S3
}

rule malware_1008
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious"

    strings:
        $S1 = /function\s\w{3,15}\(\$\w{1,15},\s\$\w{1,15}\){\$\w{3,7}\s=\s'';\sfor\(\$i=0;\s\$i\s<\sstrlen\(\$\w{0,15}\);\s\$\w{1}\+\+\)\{\$\w{3,7}\s\.=\s\w{0,7}\(\$\w{0,15}\[\$\w{0,15}\[\$\w{1}\]\]\)\s\?\s\$\w{0,10}\[\$\w{0,15}\[\$\w{1}\]\]\s:\s\$\w{0,15}\[\$\w{1}\];}\s\$\w{3,7}="\w{3,7}"\s\.\s"\w{0,10}";\w{0,10}\s\$\w{3,7}\(\$\w{0,10}\);\}/
	$S2 = /eval\/\*\w{3,10}\*\/\(/

    condition:
        $S1 and $S2
}

rule malware_1009
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious"

    strings:
        $S1 = { 6261736536345f6465636f64652822504439776148414e436d5679636d397958334a6c634739 }
        $S2 = { 7374725f7265706c61636528226b222c202265222c2073747272657628 }
        $S3 = { 286261736536345f6465636f646528245f504f53545b305d29293b }

    condition:
        $S1 and $S2 and $S3
}

rule malware_1010
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious"

    strings:
	$S1 = /basename\/\*\w{1,7}\*\/\(\/\*\w{1,7}\*\/trim\/\*\w{1,7}\*\/\(\/\*\w{1,7}\*\/preg_replace\/\*\w{1,7}\*\/\(\/\*\w{1,7}\*\/rawurldecode/
	$S2 = /substr\/\*\w{1,7}\*\/\(\/\*\w{1,7}\*\/str_repeat\//
	$S3 = /strlen\/\*\w{1,7}\*\/\(\/\*\w{1,7}\*\//

    condition:
	all of them
}

rule malware_1011
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious/file_upload"

    strings:
	$S1 = { 245f5345525645525b2752454d4f54455f41444452275d3b }
	$S2 = { 245f46494c45535b2266696c656e616d65225d5b22746d705f6e616d65225d }
	$S3 = { 6563686f20223c6120687265663d5c222466696c655c223e2466696c653c2f613e223b }

    condition:
	all of them
}

rule malware_1012
{
    meta:
        author = "SathishShan"
        last_updated = "2019-08-24"
        category = "malicious/shell"

    strings:
         $S1 = { 245f504f53545b246b65795d203d207374726970736c6173686573282476616c7565293b }
         $S2 = /\(\(\$perms\s&\s0x[0-9]{4}\)/

    condition:
         $S1 and $S2
}

rule malware_1013
{
    meta:
        author = "prakashnoob"
        last_updated = "2019-08-25"
        category = "malicious/backdoor/asp"
        
    strings:        
         $S1 = /pejvak/i
         $S2 = /hacker/i
         $S3 = /byp4ss/
	 
    condition:
         ( $S1 or $S2 ) and $S3
}

rule malware_1014
{
    meta:
        author = "prakashnoob"
        last_updated = "2019-08-25"
        category = "malicious/spam/seo"
        
    strings:        
         $S1 = /OO0O000O00OO0/i
         $S2 = /MSXML2/
                  
    condition:
         $S1 and $S2
}

rule malware_1015
{
    meta:
        author = "prakashnoob"
        last_updated = "2019-08-25"
        category = "malicious/backdoor/htaccess"
        
    strings:        
         $S1 = /cgi-script /i
                      
    condition:
         $S1 
}
